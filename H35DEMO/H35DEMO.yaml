
name    : H35DEMO
version : 2.0.0

transfer_layer:
  - name     : USB
    type     : SiUsb
    init     :
        bit_file : ../firmware/bit/H35DEMO.bit


hw_drivers:
  - name      : GPAC
    type      : GPAC
    interface : USB
    base_addr : 0x0
    init      :
        no_calibration : True

  - name      : CMD
    type      : cmd_seq
    interface : USB
    base_addr : 0x10000

  - name      : SRAM
    type      : sram_fifo
    interface : USB
    base_addr : 0x18100
    base_data_addr : 0x0001000000000000

  - name      : TLU
    type      : tlu
    interface : USB
    base_addr : 0x18200

  - name      : FE
    type      : fei4_rx
    interface : USB
    base_addr : 0x18300

  - name      : gpio_rx
    type      : gpio
    interface : USB
    base_addr : 0x18800

#### adc
  - name      : SPI_FADC
    type      : spi
    interface : USB
    base_addr : 0x18840
    mem_bytes : 2
  - name      : fadc0_rx
    type      : fadc_rx
    interface : USB
    base_addr : 0x18280
  - name      : fadc1_rx
    type      : fadc_rx
    interface : USB
    base_addr : 0x182A0
  - name      : fadc2_rx
    type      : fadc_rx
    interface : USB
    base_addr : 0x182C0
  - name      : fadc3_rx
    type      : fadc_rx
    interface : USB
    base_addr : 0x182E0

#### ccpd
  - name      : ccpd_spi
    type      : spi
    interface : USB
    base_addr : 0x18900
    mem_bytes : 187
  - name      : ccpd_spi_a
    type      : spi
    interface : USB
    base_addr : 0x18B00
    mem_bytes : 187
#  - name      : ccpd_spi_b
#    type      : spi
#    interface : USB
#    base_addr : 0x18D00
#    mem_bytes : 187

#  - name      : ccpd_spi_n
#    type      : spi
#    interface : USB
#    base_addr : 0x18F00
#    mem_bytes : 187

#  - name      : CCPD_RX_ADDR
#    type      : fast_spi_rx
#    interface : USB
#    base_addr : 0x188e0
#  - name      : CCPD_RX_TIMESTAMP
#    type      : fast_spi_rx
#    interface : USB
#    base_addr : 0x188d0

  - name      : ccpd_gpio_adc_th
    type      : gpio
    interface : USB
    base_addr : 0x18890
    size : 16

  - name      : ccpd_gpio_sw
    type      : gpio
    interface : USB
    base_addr : 0x19100
    size : 8

  - name      : CCPD_GATE
    type      : pulse_gen
    interface : USB
    base_addr : 0x188C0
  - name      : CCPD_INJ
    type      : pulse_gen
    interface : USB
    base_addr : 0x188B0

registers:
  - name        : V_in
    type        : FunctionalRegister
    hw_driver   : GPAC
    arg_names   : [value]
    arg_add     : {'channel': 'PWR1'}
  - name        : dummy
    type        : FunctionalRegister
    hw_driver   : GPAC
    arg_names   : [value]
    arg_add     : {'channel': 'PWR0'}
  - name        : CCPD_INJ_LOW
    type        : FunctionalRegister
    hw_driver   : GPAC
    arg_names   : [ value ]
    arg_add     : { 'channel': 'INJ1'}
  - name        : CCPD_INJ_HIGH
    type        : FunctionalRegister
    hw_driver   : GPAC
    arg_names   : [ value ]
    arg_add     : { 'channel': 'INJ0'}

  - name        : ADCref0
    type        : FunctionalRegister
    hw_driver   : GPAC
    arg_names   : [value]
    arg_add     : {'channel': 'VSRC0'}
  - name        : ADCref1
    type        : FunctionalRegister
    hw_driver   : GPAC
    arg_names   : [value]
    arg_add     : {'channel': 'VSRC1'}
  - name        : ADCref2
    type        : FunctionalRegister
    hw_driver   : GPAC
    arg_names   : [value]
    arg_add     : {'channel': 'VSRC2'}
  - name        : ADCref3
    type        : FunctionalRegister
    hw_driver   : GPAC
    arg_names   : [value]
    arg_add     : {'channel': 'VSRC3'}

  - name        : ENABLE_CHANNEL
    type        : StdRegister
    hw_driver   : gpio_rx
    size        : 8
    fields :
      - name    : NC1
        size    : 1
        offset  : 5
      - name    : ADC
        size    : 1
        offset  : 4
      - name    : CCPD_TDC
        size    : 1
        offset  : 3
      - name    : NC
        size    : 1
        offset  : 2
      - name    : TLU
        size    : 1
        offset  : 1
      - name    : FE
        size    : 1
        offset  : 0

  - name        : CCPD_SW
    type        : StdRegister
    hw_driver   : ccpd_gpio_sw
    size        : 8
    fields :
      - name    : NC1
        size    : 5
        offset  : 7
      - name    : CMD_TRIG # 0: none, 1: MONHIT, 2: TLU, 3: CCPD_GATE(inj)
        size    : 2
        offset  : 2
      - name    : ADC_TRIG_GATE
        size    : 1
        offset  : 0

  - name        : CCPD_ADC_TH
    type        : StdRegister
    hw_driver   : ccpd_gpio_adc_th
    size        : 16
    fields:
      - name    : VALUE
        size    : 14
        offset  : 13
      - name    : SW
        size    : 1
        offset  : 14
      - name    : STATUS
        size    : 1
        offset  : 15

  - name        : CCPD_CONF_A
    type        : StdRegister
    hw_driver   : ccpd_spi_a
    size        : 1491
    fields:
      - name    : DACOut0
        size    : 6
        offset  : 5
        #bit_order: [5,4,3,2,1,0] default
        bit_order: [0,1,2,3,4,5]
      - name    : SPARE0
        size    : 1
        offset  : 6

      - name    : DACOut1
        size    : 6
        offset  : 12
      - name    : SPARE1
        size    : 1
        offset  : 13

      - name    : DACOut2
        size    : 6
        offset  : 19
      - name    : SPARE2
        size    : 1
        offset  : 20

      - name    : DACOut3
        size    : 6
        offset  : 26
      - name    : SPARE3
        size    : 1
        offset  : 27

      - name    : DACOut4
        size    : 6
        offset  : 33
      - name    : SPARE4
        size    : 1
        offset  : 34

      - name    : DACOut5
        size    : 6
        offset  : 40
      - name    : SPARE5
        size    : 1
        offset  : 41

      - name    : BLR
        size    : 6
        offset  : 47
        bit_order: [0,1,2,3,4,5]
      - name    : SPARE6
        size    : 1
        offset  : 48

      - name    : VNBias
        size    : 6
        offset  : 54
        bit_order: [0,1,2,3,4,5]
      - name    : SPARE7
        size    : 1
        offset  : 55

      - name    : VNFB
        size    : 6
        offset  : 61
        bit_order: [0,1,2,3,4,5]
      - name    : SPARE8
        size    : 1
        offset  : 62

      - name    : DACOut9
        size    : 6
        offset  : 68
      - name    : SPARE9
        size    : 1
        offset  : 69

      - name    : DACOut10
        size    : 6
        offset  : 75
      - name    : SPARE10
        size    : 1
        offset  : 76

      - name    : DACOut11
        size    : 6
        offset  : 82
      - name    : SPARE11
        size    : 1
        offset  : 83

      - name    : VNLogic
        size    : 6
        offset  : 89
        bit_order: [0,1,2,3,4,5]
      - name    : SPARE12
        size    : 1
        offset  : 90

      - name    : VPLoad
        size    : 6
        offset  : 96
        bit_order: [0,1,2,3,4,5]
      - name    : SPARE13
        size    : 1
        offset  : 97

      - name    : VNSF
        size    : 6
        offset  : 103
        bit_order: [0,1,2,3,4,5]
      - name    : SPARE14
        size    : 1
        offset  : 104

      - name    : VP
        size    : 6
        offset  : 110
        bit_order: [0,1,2,3,4,5]
      - name    : SPARE15
        size    : 1
        offset  : 111

      - name    : VPAB
        size    : 6
        offset  : 117
        bit_order: [0,1,2,3,4,5]
      - name    : EnCCPD
        size    : 1
        offset  : 118

      - name    : ROW
        size    : 4
        repeat  : 23
        offset  : 210
        fields  :
            - name    : RamLd
              size    : 1
              offset  : 3
            - name    : Ampout
              size    : 1
              offset  : 2
            - name    : AmpToTest
              size    : 1
              offset  : 1
            - name    : InjEn
              size    : 1
              offset  : 0
      - name    : COL
        size    : 4
        offset  : 1410
        repeat  : 300
        fields  :
            - name    : MUX
              size    : 1
              offset  : 3
            - name    : InjEn
              size    : 1
              offset  : 2
            - name    : TestToAnaBuf
              size    : 1
              offset  : 1
            - name    : CaliAnaBuf
              size    : 1
              offset  : 0
      - name    : DIGI
        size    : 80
        offset  : 1490

    init    :
        DACOut0 : 0x3F
        SPARE0  : 1
        DACOut1 : 0x3F
        SPARE1  : 0
        DACOut2 : 0x3F
        SPARE2  : 0
        SPARE3  : 0
        DACOut4 : 0x3F
        SPARE4  : 0
        DACOut5 : 0x3F
        SPARE5  : 1
        SPARE6  : 0
        SPARE7  : 0
        SPARE8  : 0
        DACOut9 : 0x3F
        SPARE9  : 0
        DACOut10 : 0x3F
        SPARE10  : 0
        DACOut11 : 0x3F
        SPARE11  : 0
        SPARE12  : 0
        SPARE13  : 1
        SPARE14  : 1
        SPARE15  : 1
        DIGI    : 0
